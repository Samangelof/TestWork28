
# FastAPI Task Management System

## Оглавление

- [Описание проекта](#описание-проекта)
- [Архитектура проекта](#архитектура-проекта)
- [Технический стек](#технический-стек)
- [Установка и запуск](#установка-и-запуск)
  - [Установка без Docker](#установка-без-docker)
  - [Установка с Docker](#установка-с-docker)
- [API Endpoints](#api-endpoints)
  - [Аутентификация](#аутентификация-auth)
  - [Задачи](#задачи-tasks)
- [Мониторинг](#мониторинг)
  - [Prometheus](#prometheus)
  - [Grafana](#grafana)
  - [Loki](#loki)
- [Документация Swagger](#документация-swagger)
- [Тесты](#тесты)
  - [Запуск тестов](#запуск-тестов)
  - [Покрытие кода](#покрытие-кода)

## Описание проекта

REST API-сервис с аутентификацией через JWT. Разработан на FastAPI с использованием современных методов разработки на Python.

## Архитектура проекта

Проект построен на **Feature-Based архитектуре**.

Каждая фича это изолированный модуль с четкой внутренней логикой.
Никакой каши из моделей, вьюх и сервисов по всей кодовой базе.

**Это дает:**

- Высокую масштабируемость
- Ясную структуру кода без мешанины
- Минимизацию взаимных зависимостей
- Легкость внедрения новых фич без поломки старого кода

**Feature Base** — это не просто "структура папок".
Это взрослый подход к разработке систем, где доминируют функциональные связи, а не случайные зависимости.
Проект рассчитан на реальное масштабирование, а не на демонстрацию "игрушечного" MVP.

**Ключевые возможности:**

- Регистрация и аутентификация пользователей
- Создание, редактирование, удаление задач
- Фильтрация и поиск задач
- Мониторинг и логирование
- Контейнеризация с Docker
- Автоматическая генерация Swagger документации

## Технический стек

- **Язык программирования**: Python 3.10+
- **Фреймворк**: FastAPI
- **ORM**: SQLAlchemy
- **База данных**: PostgreSQL
- **Аутентификация**: JWT tokens
- **Контейнеризация**: Docker, Docker Compose
- **Тестирование**: pytest
- **Мониторинг**: Prometheus, Grafana, Loki
- **Документация**: Swagger (через FastAPI)

## Установка и запуск

### Установка без Docker

1. **Клонировать репозиторий**
   ```bash
   git clone https://github.com/Samangelof/TestWork28.git
   cd TestWork28
   ```
2. **Создать виртуальное окружение**
   ```bash
   python -m venv env
   source env/bin/activate  # для Linux/macOS
   # или
   env\Scripts\activate  # для Windows
   ```
3. **Установить зависимости**
   ```bash
   pip install -r requirements.txt
   ```
4. **Настроить переменные окружения**
   ```bash
   cp .env.example .env
   # Заполнить .env своими данными
   ```
5. **Запустить миграции базы данных**
   ```bash
   alembic upgrade head
   ```
6. **Запустить приложение**
   ```bash
   uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
   ```
7. **Проверить работу API**
   Открыть в браузере: [http://localhost:8000/docs](http://localhost:8000/docs)

### Установка с Docker

1. **Клонировать репозиторий**

   ```bash
   git clone https://github.com/Samangelof/TestWork28.git
   cd TestWork28
   ```
2. **Настроить переменные окружения**

   ```bash
   cp .env.example .env
   # Отредактировать .env файл с вашими настройками
   ```
3. **Собрать и запустить контейнеры**

   ```bash
   docker-compose up -d
   ```
4. **Проверить работу API**

   Открыть в браузере: [http://localhost:8000/docs](http://localhost:8000/docs)

## API Endpoints

### Аутентификация (Auth)

#### Регистрация пользователя

- **URL**: `/api/users/register`
- **Метод**: `POST`
- **Описание**: Регистрация нового пользователя

#### Авторизация

- **URL**: `/api/users/login`
- **Метод**: `POST`
- **Описание**: Получение JWT токенов для аутентификации

#### Обновление токена

- **URL**: `/api/users/refresh`
- **Метод**: `POST`
- **Описание**: Обновление access токена с помощью refresh токена

### Задачи (Tasks)

> **Примечание**: Все эндпоинты для задач требуют аутентификации. Передавать заголовок `Authorization: Bearer {access_token}`.

#### Создание задачи

- **URL**: `/api/tasks`
- **Метод**: `POST`
- **Описание**: Создание новой задачи

#### Получение списка задач

- **URL**: `/api/tasks`
- **Метод**: `GET`
- **Описание**: Получение списка задач с фильтрацией

#### Поиск задач

- **URL**: `/api/tasks/search`
- **Метод**: `GET`
- **Описание**: Поиск задач по названию или описанию

#### Получение задачи по ID

- **URL**: `/api/tasks/{task_id}`
- **Метод**: `GET`
- **Описание**: Получение задачи по ID

#### Обновление задачи

- **URL**: `/api/tasks/{task_id}`
- **Метод**: `PUT`
- **Описание**: Обновление задачи по ID

#### Удаление задачи

- **URL**: `/api/tasks/{task_id}`
- **Метод**: `DELETE`
- **Описание**: Удаление задачи по ID

## Мониторинг

### Prometheus

Собирать метрики приложения через Prometheus по адресу: [http://localhost:9090](http://localhost:9090)

### Grafana

Визуализировать данные через Grafana: [http://localhost:3000](http://localhost:3000)

**Учетные данные:**

- Пользователь: admin
- Пароль: root

### Loki

Хранить и анализировать логи через Loki. Конфигурация Loki находится в `loki-config.yaml`.

## Документация Swagger

FastAPI автоматически генерирует Swagger UI:

- Открыть: [http://localhost:8000/docs](http://localhost:8000/docs)

Можно использовать его для тестирования и изучения всех доступных эндпоинтов.

## Тесты

### Запуск тестов

```bash
pytest
```

Для подробного вывода:

```bash
pytest -v
```

### Покрытие кода

Измерить покрытие тестами:

```bash
pytest --cov=app
```

Создать HTML-отчет о покрытии:

```bash
pytest --cov=app --cov-report=html
```

Открыть файл `htmlcov/index.html` в браузере для просмотра отчета.

---

## Завершение

> Код написан [человеком](https://t.me/Samangelof), который знал, что делает. И этого оказалось достаточно.
